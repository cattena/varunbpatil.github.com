<html>
<head>
    <meta charset="utf-8"/>

    <!-- TO Fancy SEARCH ENGINE -->
    <title>Varun B Patil | Basic Xmonad setup in (L)ubuntu</title>
    <meta name="description" content="Varun B Patil's blog"/>

    <!-- TO FANCY GOOGLE -->
    <meta itemprop="name" content="Varun B Patil's blog"/>
    <meta itemprop="description" content="Varun B Patil blog"/>

    <!-- TO FANCY FACEBOOK -->
    <meta property="og:title" content="Varun B Patil's blog" />
    <meta property="og:type" content="blog" />
    <meta property="og:url" content="http://varunbpatil.github.com/" />
    <meta property="og:site_name" content="Varun B Patil's blog" />

    <meta name="keywords" content="Varun B Patil's blog"/>
    <meta name="robots" content="noodp" />

    <link rel="stylesheet" media="all" href="/style.css"/>
    <link rel="stylesheet" media="all" href="/style_accordion.css"/>
    <link rel="shortcut icon" href="/favicon.ico"/>

    <link href='http://fonts.googleapis.com/css?family=Quantico' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Trade+Winds' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Autour+One' rel='stylesheet' type='text/css'>


    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32267446-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






    <!--jQuery-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="../js/custom.js"></script>
    <script type="text/javascript" src="../js/smoothscroll.js"></script>

</head>
<body>

    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter21595372 = new Ya.Metrika({id:21595372,
                        webvisor:true,
                        clickmap:true,
                        trackLinks:true,
                        accurateTrackBounce:true,
                        trackHash:true});
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
    </script>
    <!-- /Yandex.Metrika counter -->

    <div id="wrapper">
        <div style="width:100%;position:fixed;z-index:99;box-shadow:0px 5px 5px #888888;">
        <header id="header">
            <div class="inner">
                <a href="/"><h1 id="site-name">Varun B Patil</h1></a>
                <nav id="navigation">
                <ul class="navigation">
                
                    
                    
                        
                            
                        
                    
                    <li>
                    <span class="">
                    <a class="" href="/index.html" target="">HOME</a>
                    </span>
                    </li>
                
                    
                    
                        
                            
                        
                    
                    <li>
                    <span class="">
                    <a class="" href="/profile/index.html" target="">PROFILE</a>
                    </span>
                    </li>
                
                    
                    
                        
                            
                        
                            
                                
                            
                        
                    
                    <li>
                    <span class="current">
                    <a class="current" href="/blog/index.html" target="">BLOG</a>
                    </span>
                    </li>
                
                    
                    
                        
                            
                        
                            
                        
                            
                        
                    
                    <li>
                    <span class="">
                    <a class="" href="/tag/index.html" target="">TAGS</a>
                    </span>
                    </li>
                
                </ul>
                </nav>
            </div>
        </header>
        </div>

<br />
<br />
<br />
<div id="main">
<article class="post">
    <header class="post-header">
        <h1 class="post-title">Basic Xmonad setup in (L)ubuntu</h1>
    </header><!-- post-title -->
    <div class="post-meta">
        <time class="date" datetime="2013-09-20T00:00:00+05:30">20 September 2013</time>
        <cite><em> &nbsp;&nbsp;by</em> Varun B Patil</cite>

    </div><!-- .post-meta -->
    <p class="postpage"><span style="font-style:italic">tagged under</span>&nbsp;&nbsp;
    
        <a class="tag" href="/tags/linux/">linux</a> &nbsp;
    
    </p>
    <br />
    <div class="post">
      <p><strong>Updated 22-Sep-2013 : Autostart favorite applications on login</strong> [ <a href="#UPDATE22SEP2013">jump to this</a> ]
<br /><br />
<strong>Updated 23-Sep-2013 : Toggling visibility of system-tray application &quot;Trayer&quot;</strong> [ <a href="#UPDATE23SEP2013">jump to this</a> ]</p>

<p>Xmonad is a featureful and productive tiling window manager written in Haskell. The following is a super simple setup on Lubuntu (can be setup similarly on Ubuntu based systems).</p>

<p><img src="/images/xmonad.png" width="750px" /></p>

<h4>Installation</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ sudo apt-get install ghc6 libx11-dev cabal-install gmrun
$ sudo cabal update
$ sudo cabal install xmonad --global
$ sudo cabal install xmonad-contrib --global
</code></pre></div>
<h4>Setup</h4>

<p>Create the file <strong>/usr/share/xsessions/xmonad.desktop</strong> with the following contents (root required).</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">[Desktop Entry]
Name=XMonad
Comment=Lightweight tiling window manager
Exec=xmonad
Type=XSession
</code></pre></div>
<p>Give the above file proper permissions.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ sudo chown root:root /usr/share/xsessions/xmonad.desktop
</code></pre></div>
<p>The above file is required to give you the option to choose xmonad as your window manager at the login prompt.</p>

<p>Next, let us configure xmonad itself. Create the file <strong>~/.xmonad/xmonad.hs</strong> with the following contents.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">import XMonad
import XMonad.Hooks.ManageDocks

main = do
    xmonad $ defaultConfig
        { modMask = mod4Mask -- make Win as mod key
        , terminal = &quot;terminator&quot; -- replace with your fav terminal emu
        , manageHook = manageDocks &lt;+&gt; manageHook defaultConfig -- ignore docks
        }
</code></pre></div>
<p>Finally the most imp thing -- aesthetics. If you use xmonad with just the above setup, you will find that gtk applications like firefox look terribly ugly, but fixing this issue is simple. So, go ahead and do it before you start using xmonad.</p>

<p>Launch <strong>gtk-chtheme</strong> and select your preferred gtk-2.0 theme and any font that catches your eye as well. Save your settings. You should now find the file <strong>~/.gtkrc-2.0</strong>.</p>

<p>Now, let us fix some ugly gtk-3.0 apps as well. Create the file <strong>~/.config/gtk-3.0/settings.ini</strong> with the following contents (choose your preferred themes and fonts).</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">[Settings]
gtk-theme-name = Lubuntu-default
gtk-icon-theme-name = Lubuntu
gtk-font-name = Ubuntu Medium 11
</code></pre></div>
<p>Thats it. Logout and log in selecting xmonad as your session (instead of the default Lubuntu) at the login prompt. You are greeted with a plain screen. Press <strong>Win+Shift+Ret</strong> to launch the <strong>terminal</strong> or <strong>Win+Shift+p</strong> to launch your fav apps via <strong>gmrun</strong>. For more basic keybindings and usage, checkout the man page of xmonad or head to <a href="http://xmonad.org/tour.html">Xmonad Official Doc</a>.</p>

<p>You might also like to have a tray for your fav applets like nm-applet | dropbox | battery status | pidgin, etc. Read on.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ sudo apt-get install trayer
</code></pre></div>
<p>Create a shell script <strong>~/.autostart</strong> with execute permission with the following contents.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">#!/bin/bash

mpd &amp;&gt;/dev/null &amp;
dropbox start &amp;&gt;/dev/null &amp;
redshift -l 12.9667:77.5667 -t 3700:3700 &amp;&gt;/dev/null &amp;

trayer --edge bottom --align right --SetDockType true \
--SetPartialStrut true --expand true --width 20 --height 25 &amp;&gt;/dev/null &amp;

sleep 1
nm-applet --sm-disable &amp;&gt;/dev/null &amp;
</code></pre></div>
<p>I am using this script to start a few applications I use frequently like mpd(ncmpcpp), dropbox, redshift.</p>

<p>Then, I am creating a tray with trayer, and then launching nm-applet which I can then access from the tray which is visible on all workspaces (Win+1 to Win+9) courtesy of the managehook in our xmonad.hs configuration file.</p>

<p>At the moment, I am using this shell script to launch apps manually after logging into xmonad. My attempts at using .xinitrc or .xsession to automate the same have failed. I would appreciate it if anyone could point me in the right direction. I will keep this page updated as and when I find something new and noteworthy.</p>

<p>Comments and feedback and tips|tricks are welcome.</p>

<p><a id="UPDATE22SEP2013"></a></p>

<p><br /><br /><br /></p>

<p><strong>UPDATE SEP 22</strong></p>

<p>Thanks to <strong>@kasbah</strong> for providing a solution to automate the startup of my fav applications in the comments below, which I provide here for completeness. The following is my new <strong>xmonad.hs</strong> to autostart applications.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">import XMonad
import XMonad.Hooks.DynamicLog
import XMonad.Hooks.ManageDocks
import XMonad.Util.Run(spawnPipe)
import XMonad.Util.EZConfig(additionalKeys)
import System.IO

main = do
    xmonad $ defaultConfig
        { modMask = mod4Mask
        , terminal = &quot;terminator&quot;
        , manageHook = manageDocks &lt;+&gt; manageHook defaultConfig
        , startupHook = startup
        } `additionalKeys`
        [ ((mod4Mask, xK_q), spawn &quot;killall redshift nm-applet trayer&quot;
          &gt;&gt; restart &quot;xmonad&quot; True)
        ]

startup :: X()
startup = do
    spawn &quot;mpd&quot;
    spawn &quot;dropbox start&quot;
    spawn &quot;redshift -l 12.9667:77.5667 -t 3700:3700&quot;
    spawn &quot;trayer --edge bottom --align right --SetDockType true
           --SetPartialStrut true --expand true --widthtype percent
           --width 100 --height 25&quot;
    spawn &quot;nm-applet&quot;
</code></pre></div>
<p>This is basically using the startupHook concept to start applications after xmonad loads. The problem with using startupHook alone is that the applications are (re)started everytime I reload the xmonad config with Win+q. To overcome this limitation, I have rebinded Win+q to first kill the applications that I autostarted before restarting xmonad itself.</p>

<p><a id="UPDATE23SEP2013"></a></p>

<p><br /><br /><br /></p>

<p><strong>UPDATE SEP 23</strong></p>

<p>The problem with the above xmonad config is that the trayer gets blocked by open apps. To use the trayer applets, you will have to go to an empty workspace (with no open apps). To overcome this limitation, use the xmonad.hs below which sets the strut option for trayer and then asks xmonad not to block struts with the application windows. There is also a keybinding <strong>Win+b</strong> to toggle the struts(toggle the display of trayer), thus making trayer accessible even when other apps are open.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">import XMonad
import XMonad.Hooks.DynamicLog
import XMonad.Hooks.ManageDocks
import XMonad.Util.Run(spawnPipe)
import XMonad.Util.EZConfig(additionalKeys)
import System.IO

main = do
    xmonad $ defaultConfig
        { modMask = mod4Mask
        , terminal = &quot;terminator&quot;
        , manageHook = manageDocks &lt;+&gt; manageHook defaultConfig
        , layoutHook = avoidStruts  $  layoutHook defaultConfig
        , startupHook = startup
        } `additionalKeys`
        [ ((mod4Mask, xK_q), spawn &quot;sudo killall redshift nm-applet trayer&quot;
          &gt;&gt; restart &quot;xmonad&quot; True)
        , ((mod4Mask, xK_z), spawn &quot;slock&quot;)
        , ((mod4Mask, xK_b), sendMessage ToggleStruts)
        ]

startup :: X()
startup = do
    spawn &quot;mpd&quot;
    spawn &quot;dropbox start&quot;
    spawn &quot;redshift -l 12.9667:77.5667 -t 3700:3700&quot;
    spawn &quot;trayer --edge bottom --align right --SetDockType true
           --SetPartialStrut true --expand true --widthtype percent
           --width 100 --height 25&quot;
    spawn &quot;sudo nm-applet&quot;
</code></pre></div>
      <br />
      
        <a class="prev_next" style="float: left;" href="/2013/08/19/eom">&laquo;&nbsp;older posts</a>
      
      
        <a class="prev_next" style="float: right;" href="/2013/09/28/dwm">newer posts&nbsp;&raquo;</a>
      
      <br /><br /><br /><br />
      <b>other articles you might like</b><br />
      
    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2014/08/19/t440s-touchpad">Configuring Lenovo T440s touchpad in Linux</a>
            </li>
            
        
    

    
    
        
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2014/06/01/truecrypt-alt">Alternatives to Truecrypt on Linux</a>
            </li>
            
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2014/06/01/network-command-line">Connecting to wired/wireless networks via command line</a>
            </li>
            
        
    

    
    
        
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2014/03/21/reverse-tethering">Android reverse USB tethering</a>
            </li>
            
        
    

    
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2013/11/18/linux-tricks-3">Linux command line tools and tricks - Part 3</a>
            </li>
            
        
    
        
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2013/09/28/dwm">Basic dwm setup in (L)ubuntu</a>
            </li>
            
        
    

    
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2013/08/19/eom">EOM a.k.a End of Mail a.k.a Emacs + offlineimap + mu4e</a>
            </li>
            
        
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2013/08/12/firefox-addon">First attempt at developing a Firefox addon</a>
            </li>
            
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2013/08/05/ncp">Bash script to perform super-fast file transfer using netcat and tar</a>
            </li>
            
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2013/07/06/jekyll-build-fail">Jekyll : Handling Github page build failure and Jekyll plugins on Github</a>
            </li>
            
        
    
        
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2013/05/26/emacs-newbie">Emacs newbie cheat sheet -- from a vim convert</a>
            </li>
            
        
    
        
    
        
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2013/04/11/ncmpcpp">ncmpcpp : ncurses based music player for Linux</a>
            </li>
            
        
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2013/03/02/apps-zip">How to create a custom CWM recovery flash-able android apps zip file in Linux via command line</a>
            </li>
            
        
    
        
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2013/02/19/cli-task">Task Warrior - The best CLI task manager for Linux</a>
            </li>
            
        
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2012/12/27/kernel">Custom kernel in Ubuntu (also generate .deb package)</a>
            </li>
            
        
    
        
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2012/10/01/linux-tricks-2">Linux command line tools and tricks - Part 2</a>
            </li>
            
        
    
        
    
        
    

    
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2012/09/19/linux-tricks">Superb Linux command line tools and tricks for Linux geeks</a>
            </li>
            
        
    
        
    
        
    

    
    
        
    

    
    
        
    

    
    
        
    

    
    
        
    

    
    
        
    
        
    

    
    
        
    
        
    

    
    
        
    

    
    
        
    

    
    
        
    
        
    
        
    

    
    
        
    
        
    
        
    

    
    
        
    
        
            <li style="list-style:none;font-size:16px;margin-bottom:-3px;">
                <a href="/2012/01/10/rsa-tcl">RSA encryption using Tcl</a>
            </li>
            
        
    

    
    
        
    
        
    

    </div>
    <br />
    <br />
    <br />


<p style="float: left; margin-top: 4px;">Share this post &rArr;&nbsp;&nbsp;</p>
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style addthis_32x32_style">
<a style="border-bottom:0" class="addthis_button_preferred_1"></a>
<a style="border-bottom:0" class="addthis_button_preferred_2"></a>
<a style="border-bottom:0" class="addthis_button_preferred_3"></a>
<a style="border-bottom:0" class="addthis_button_preferred_4"></a>
<a style="border-bottom:0" class="addthis_button_compact"></a>
<a style="border-bottom:0" class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=ra-4fd1e13840ac7423"></script>
<!-- AddThis Button END -->


<br />
<br />
<br />
<br />

</article><!-- .post -->
</div>

<div class="fb_comments">
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'varunbpatil'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>





</div>

<br />
<br />
<br />
<footer id="footer" style="clear: both">
    <div class="inner">

        <p class="social" style="margin-top: -10px;">Contact me &nbsp;&rarr;&nbsp;&nbsp;
                <a title="facebook" class="social" href="http://www.facebook.com/varunbpatil" target="_blank"><img src="/PNGs/facebook.png" width="32px" /></a>
                <a title="twitter" class="social" href="http://twitter.com/#!/varunbpatil" target="_blank"><img src="/PNGs/twitter.png" width="32px" /></a>
                <a title="linkedin" class="social" href="https://www.linkedin.com/in/varunbpatil/" target="_blank"><img src="/PNGs/linkedin.png" width="32px" /></a>
                <a title="google+" class="social" href="https://plus.google.com/112161568047512619329/posts" target="_blank"><img src="/PNGs/googleplus.png" width="32px" /></a>
                <a title="github" class="social" href="https://github.com/varunbpatil/" target="_blank"><img src="/PNGs/github.png" width="32px" /></a>
                <a title="gmail" class="social" href="mailto:varun.basavaraj.patil@gmail.com" target="_blank"><img src="/PNGs/gmail.png" width="32px" /></a>
        </p>



        <p class="social" style="margin-bottom: 23px;">Subscribe to my posts &nbsp;&rarr;&nbsp;&nbsp;
                <a title="subscribe via RSS" class="social" href="http://feeds.feedburner.com/varunbpatil" target="_blank"><img src="/PNGs/rss.png" width="36px" /></a>
                <a title="subscribe via e-mail" class="social" href="http://feedburner.google.com/fb/a/mailverify?uri=varunbpatil&amp;loc=en_US" target="_blank"><img src="/PNGs/mail.png" width="36px" /></a>
                <a class="social" href="http://feeds.feedburner.com/varunbpatil" target="_blank"><img src="http://feeds.feedburner.com/~fc/varunbpatil?bg=BDBDBD&amp;fg=000000&amp;anim=0" height="29" width="88" style="border:0" alt="" /></a>
        </p>




        <p class="social">powered by &nbsp;&rarr;&nbsp;&nbsp;
        <a class="social" href="https://github.com/mojombo/jekyll"><span>jekyll</span></a>
        <a class="social" href="https://github.com/Shopify/liquid"><span>liquid</span></a>
        <a class="social" href="https://github.com/"><span>github</span></a>
        </p>
    </div>
</footer>

</div>
</body>
</html>

